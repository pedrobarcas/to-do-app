<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ui/viewmodels/groupViewModel.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ui/viewmodels/groupViewModel.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Observable } from "../../domain/Observable";

/**
 * ViewModel responsável por gerenciar grupos de tarefas ou entidades similares.
 *
 * Essa classe atua como intermediária entre a camada de domínio e a interface,
 * encapsulando operações de leitura, edição e remoção de grupos, além de notificar
 * automaticamente os observadores sobre mudanças relevantes.
 *
 * @class
 * @extends Observable
 * @since 1.0.0
 *
 * @example
 * const vm = new GroupViewModel(repository, groupRepository, service);
 *
 * vm.subscribe((event) => console.log("Grupo modificado:", event));
 * 
 * await vm.edit(grupo, { name: "Novo Nome" });
 * await vm.remove("group-123");
 */
export class GroupViewModel extends Observable {
  /**
   * Cria uma nova instância de GroupViewModel.
   *
   * @constructor
   * @param {Object} repository - Repositório principal responsável pelas operações de persistência de grupos.
   * Deve implementar os métodos `find(key)`, `edit(object)` e `remove(object)`.
   * @param {Object} groupRepository - Repositório auxiliar responsável por relacionamentos ou índices de grupos.
   * Deve implementar o método `remove(key)`.
   * @param {Object} service - Serviço de domínio responsável por aplicar regras de negócio e validações.
   * Deve implementar o método `edit(object, updates)`.
   *
   * @example
   * const vm = new GroupViewModel(groupRepo, subRepo, groupService);
   */
  constructor(repository, groupRepository, service) {
    super();
    /**
     * Repositório principal de persistência.
     * @type {Object}
     * @private
     */
    this.repository = repository;

    /**
     * Repositório auxiliar (ex: estrutura de índices ou associação de grupos).
     * @type {Object}
     * @private
     */
    this.groupRepository = groupRepository;

    /**
     * Serviço de domínio usado para aplicar regras de negócio.
     * @type {Object}
     * @private
     */
    this.service = service;
  }

  /**
   * Busca um grupo com base na chave fornecida.
   *
   * @async
   * @param {string} key - Identificador do grupo a ser buscado.
   * @returns {Promise&lt;Object|null>} O grupo encontrado ou `null` caso não exista.
   *
   * @example
   * const group = await vm.find("group-001");
   */
  async find(key) {
    const resolution = await this.repository.find(key);
    return resolution;
  }

  /**
   * Remove um grupo e seus vínculos associados.
   *
   * Este método limpa todos os observadores, busca o grupo correspondente e executa 
   * a remoção tanto no repositório principal quanto no auxiliar.  
   * Após a exclusão, notifica todos os observadores informando a chave do grupo removido.
   *
   * @async
   * @param {string} key - Identificador do grupo a ser removido.
   * @returns {Promise&lt;void>}
   *
   * @fires Observable#notify
   * @example
   * await vm.remove("group-123");
   */
  async remove(key) {
    this.unsubscribeAll();
    const group = await this.repository.find(key);
    await this.repository.remove(group);
    await this.groupRepository.remove(key);

    this.notify({ removed: key });
  }

  /**
   * Edita um grupo existente aplicando as atualizações informadas.
   *
   * Esse método utiliza o `service` para aplicar regras de negócio,
   * envia as modificações para o repositório e notifica os observadores 
   * com a nova versão do grupo.
   *
   * @async
   * @param {Object} group - Grupo original que será atualizado.
   * @param {Object} [updates={}] - Objeto contendo os campos a serem modificados.
   * @returns {Promise&lt;Object>} O grupo atualizado retornado pelo repositório.
   *
   * @fires Observable#notify
   * @example
   * const updated = await vm.edit(group, { name: "Grupo Atualizado" });
   */
  async edit(group, updates = {}) {
    const updatedGroup = this.service.edit(group, updates);
    console.log(updatedGroup);
    const obj = await this.repository.edit(updatedGroup);
    console.log(obj);
    this.notify(updatedGroup);
    return obj;
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-aplica%25C3%25A7%25C3%25A3o_Reposit%25C3%25B3rio.html">aplicação/Repositório</a></li><li><a href="module-dom%25C3%25ADnio_entidades_tarefa.html">domínio/entidades/tarefa</a></li><li><a href="module-dom%25C3%25ADnio_fabricas_groupFactory.html">domínio/fabricas/groupFactory</a></li><li><a href="module-dom%25C3%25ADnio_fabricas_taskFactory.html">domínio/fabricas/taskFactory</a></li><li><a href="module-dom%25C3%25ADnio_servi%25C3%25A7os_Servi%25C3%25A7os.html">domínio/serviços/Serviços</a></li><li><a href="module-dom%25C3%25ADnio_servi%25C3%25A7os_configService.html">domínio/serviços/configService</a></li><li><a href="module-dom%25C3%25ADnio_servi%25C3%25A7os_taskService.html">domínio/serviços/taskService</a></li><li><a href="module-infraestrutura_Firestore.html">infraestrutura/Firestore</a></li><li><a href="module-infraestrutura_LocalStorage.html">infraestrutura/LocalStorage</a></li><li><a href="module-infraestrutura_taskFirestore.html">infraestrutura/taskFirestore</a></li></ul><h3>Classes</h3><ul><li><a href="CreateTaskViewModel.html">CreateTaskViewModel</a></li><li><a href="CreateViewModel.html">CreateViewModel</a></li><li><a href="DetailViewModel.html">DetailViewModel</a></li><li><a href="EditViewModel.html">EditViewModel</a></li><li><a href="FormUi.html">FormUi</a></li><li><a href="Group.html">Group</a></li><li><a href="GroupCreateViewModel.html">GroupCreateViewModel</a></li><li><a href="GroupViewModel.html">GroupViewModel</a></li><li><a href="HeaderUi.html">HeaderUi</a></li><li><a href="HomeUi.html">HomeUi</a></li><li><a href="ListTaskView.html">ListTaskView</a></li><li><a href="ListTasksViewModel.html">ListTasksViewModel</a></li><li><a href="ListViewModel.html">ListViewModel</a></li><li><a href="Observable.html">Observable</a></li><li><a href="RemoveViewModel.html">RemoveViewModel</a></li><li><a href="Repository.html">Repository</a></li><li><a href="TaskDetailView.html">TaskDetailView</a></li><li><a href="TaskDetailViewModel.html">TaskDetailViewModel</a></li><li><a href="TaskUi.html">TaskUi</a></li><li><a href="module-aplica%25C3%25A7%25C3%25A3o_Reposit%25C3%25B3rio.TaskRepository.html">TaskRepository</a></li><li><a href="module-dom%25C3%25ADnio_entidades_tarefa.Task.html">Task</a></li><li><a href="module-dom%25C3%25ADnio_servi%25C3%25A7os_Servi%25C3%25A7os.Service.html">Service</a></li><li><a href="module-dom%25C3%25ADnio_servi%25C3%25A7os_configService.ConfigService.html">ConfigService</a></li><li><a href="module-dom%25C3%25ADnio_servi%25C3%25A7os_taskService.TaskService.html">TaskService</a></li><li><a href="module-infraestrutura_Firestore.Firestore.html">Firestore</a></li><li><a href="module-infraestrutura_LocalStorage.LocalStorageRepository.html">LocalStorageRepository</a></li><li><a href="module-infraestrutura_taskFirestore.TaskFirestore.html">TaskFirestore</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Elements">Elements</a></li><li><a href="global.html#GroupCard">GroupCard</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#MainForm">MainForm</a></li><li><a href="global.html#MainHeader">MainHeader</a></li><li><a href="global.html#TaskCard">TaskCard</a></li><li><a href="global.html#TaskUiElements">TaskUiElements</a></li><li><a href="global.html#must">must</a></li><li><a href="global.html#taskDetail">taskDetail</a></li><li><a href="global.html#theme">theme</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sun Nov 02 2025 22:05:08 GMT-0300 (Horário Padrão de Brasília)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
