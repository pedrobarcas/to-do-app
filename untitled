import { TaskDetailView } from "./taskDetailView";

import { TaskService } from "../../domain/taskService.js";
import { TaskRepository } from "../../application/taskRepository.js";
import { TaskFactory } from "../../domain/factorys/taskFactory.js";
import { LocalStorageRepository } from "../../infrastructure/LocalStorage.js";
import { QueryParams } from "../../utils/getQueryParams.js";

import { TaskDetailViewModel } from "../viewmodels/taskDetailViewModel.js";
import { EditViewModel } from "../viewmodels/EditViewModel.js";
import { RemoveViewModel } from "../viewmodels/RemoveViewModel.js";

import { taskDetail } from "../../components/taskDetail";

// inst√¢ncias globais
const taskService = new TaskService([], [], []);
const queryParams = new QueryParams();

const key = queryParams.getQueryParams("key");

const taskRepository = new TaskRepository(
taskService,
new LocalStorageRepository(key)
);

// viewmodels
const taskDetailViewModel = new TaskDetailViewModel(taskRepository, queryParams);
const taskEditViewModel = new EditViewModel(taskRepository, taskService);
const taskRemoveViewModel = new RemoveViewModel(taskRepository);

// view
const taskDetailView = new TaskDetailView(
taskDetailViewModel,
taskEditViewModel,
taskRemoveViewModel,
taskDetail // function
);

export { taskDetailView };
