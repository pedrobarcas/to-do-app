import{h as a,q as f,p as w,c as D,s as M}from"./h-B9Kqazla.js";import{D as L,G as b,L as S}from"./groupForm-B5APNPYO.js";import{T as I,a as U}from"./taskDetailViewModel-CGl4_OEc.js";class V{constructor(e,s){this.factory=e,this.repository=s}create(e,s=""){const n=this.factory.create(e,s);return this.repository.save(n)}}const m=(t,e)=>{if(!t)throw new Error(`Elemento ${e} não encontrado`);return t},B=(t=document)=>({get task(){return m(t.getElementById("task"),"Input da Tarefa")},get main_content(){return m(t.querySelector(".main-content"),"Conteúdo principal")},get main_completed_tasks(){return m(t.querySelector(".main-drop-down-task"),"Seção principal de tarefas concluídas")},get completed_tasks(){return m(t.querySelector(".drop-down-task"),"Lista de tarefas concluídas")},get main_tasks(){return m(t.querySelector(".main-tasks"),"Lista de tarefas ativas")},get add_task(){return m(t.querySelector(".add-task"),"Botão de adicionar tarefa")},get main_form(){return m(t.querySelector(".main-form"),"Formulário principal")},get send_task(){return m(t.getElementById("send-task"),"Botão de envio da tarefa")},get button_completed_tasks(){return m(t.getElementById("button-completed-tasks"),"Botão de exibir tarefas concluídas")},get task_checkbox(){return t.querySelectorAll(".task-checkbox")},get tasks(){return t.querySelectorAll(".tasks")},get settings(){return m(t.getElementById("settings"),"Botão de configurações")},get settings_drop_down(){return m(t.querySelector(".settings-drop-down"),"Menu de configurações")}}),i=B();class C{static showDropDown(){i.settings_drop_down.classList.toggle("is-active")}}class N{static showForm(){i.add_task.style.display="none",i.main_form.style.display="flex"}static hideForm(){i.add_task.style.display="flex",i.main_form.style.display="none"}}class x{constructor(e,s){this.listViewModel=e,this.detailViewModel=s}showCompletedTasks(){i.completed_tasks.style.display==="none"||i.completed_tasks.style.display===""?(i.completed_tasks.style.display="flex",i.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-down"></span> Concluídas'):(i.completed_tasks.style.display="none",i.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-right"></span> Concluídas')}renderTask(e){i.main_tasks.innerHTML="",i.completed_tasks.innerHTML="",this.listViewModel.load().forEach(s=>{this.createTemplateTask(s,s.completed,e)})}createTemplateTask(e,s=!1,n){const d=a(I,{task:e,key:n}),r=d.querySelector(".task-checkbox");s?i.completed_tasks.appendChild(d):i.main_tasks.appendChild(d),r.addEventListener("click",()=>{this.detailViewModel.completedTask(e),this.renderTask(n)})}}function F(){return a("div",{className:"settings-drop-down"},a("p",{id:"changeThemeButton"},a("span",{className:"fa-solid fa-palette","aria-label":"imagem ilustrativa de uma palheta artística"}),"Alterar tema"))}function q({title:t,dropDown:e}){return a("header",{className:"main-header"},a("h1",null,t),a("div",{className:"main-settings"},a("div",{id:"settings",className:"fa-solid fa-ellipsis-vertical"})),e)}function R(){return a("section",{className:"add-task"},a("button",null,"+"))}function A(){return a("section",{className:"main-form"},a("div",{className:"content-form"},a("input",{type:"text",placeholder:"Sua tarefa",id:"task"}),a("button",{id:"send-task"},a("span",{className:"fa-solid fa-arrow-up","aria-label":"imagem ilustrativa de inclusão de uma tarefa"}))))}function G(){return a("div",{className:"settings-drop-down"},a("div",{id:"changeThemeButton",className:"drop-down-content"},a("span",{className:"fa-solid fa-palette","aria-label":"imagem ilustrativa de uma palheta artística"}),"Alterar tema"),a("div",{id:"editGroup",className:"drop-down-content"},a("span",{className:"fa-solid fa-pencil"}),"Renomear lista"),a("div",{id:"deleteGroup",className:"drop-down-content"},a("span",{className:"fa-solid fa-trash"}),"Excluir lista"))}class H{constructor({viewModels:e={},uis:s={},components:n={},config:d}){this.viewModels=e,this.uis=s,this.components=n,this.config=d,this.color=null}theme(e){const{UiElements:s}=this.uis,{groupVM:n}=this.viewModels,r={Importante:"pink-theme","Meu Dia":"green-theme"}[e];r&&s.main_content.classList.add(r),this.color=n.find(e)?.color,this.color&&document.documentElement.style.setProperty("--main-color",this.color)}bindEvents(e){const{UiElements:s,FormUi:n,HeaderUi:d,taskUI:r}=this.uis,{groupVM:l,taskCreateVM:u}=this.viewModels;s.add_task.addEventListener("click",()=>{s.settings.setAttribute("disabled","true"),n.showForm()}),s.send_task.addEventListener("click",()=>{s.settings.setAttribute("disabled","false");const c=s.task.value.trim();c&&(u.create(c),n.hideForm(),r.renderTask(e))}),s.button_completed_tasks.addEventListener("click",()=>{r.showCompletedTasks()}),s.settings.addEventListener("click",()=>{d.showDropDown()});const p=document.querySelector(".todo__form--container");document.getElementById("cancel")?.addEventListener("click",()=>{p.style.display="none"}),window.addEventListener("scroll",()=>{const c=document.querySelector(".main-header");window.scrollY>50?c?.classList.add("is-shrink"):c?.classList.remove("is-shrink")}),document.getElementById("changeThemeButton")?.addEventListener("click",()=>{s.main_content.classList.toggle("light-theme")}),document.getElementById("deleteGroup")?.addEventListener("click",()=>{l.remove(e),location.href="index.html"}),document.getElementById("editGroup")?.addEventListener("click",()=>{p.style.display="flex"}),document.querySelectorAll(".todo__form--color-content").forEach(c=>{c.addEventListener("click",T=>{const y=T.target.dataset.color;document.documentElement.style.setProperty("--main-color",y),this.color=y})}),document.getElementById("create")?.addEventListener("click",()=>{l.edit(l.find(e),{id:document.getElementById("group").value,name:document.getElementById("group").value,color:this.color}),p.style.display="none"})}render(e){const{taskUI:s,UiElements:n}=this.uis,{Header:d,ButtonAddTask:r,Form:l,DropDown:u}=this.components;s.renderTask(e),this.theme(e),n.main_content.prepend(a(this.components.groupForm,{method:"puta"}));let p=a(this.components.groupDropDown,null);this.config.get("mainGroups").includes(e)&&(p=a(u,null));const c=a(d,{title:e,dropDown:p});n.main_content.appendChild(c),n.main_content.appendChild(r()),n.main_content.appendChild(l()),this.bindEvents(e)}}class P{constructor(e,s,n){this.repository=e,this.groupRepository=s,this.service=n}find(e){return this.repository.find(e)}remove(e){const s=this.repository.find(e);this.repository.remove(s),this.groupRepository.clear(e)}edit(e,s={}){const n=s.id&&s.id!==e.id,d=s.name&&s.name!==e.name;if(n||d){const l=e.name,u=s.name||e.name,p=JSON.parse(localStorage.getItem(l))||[];l!==u&&(localStorage.setItem(u,JSON.stringify(p)),localStorage.removeItem(l)),this.repository.remove(e),this.groupRepository.clear(e.id);const c=this.service.edit(e,s);return this.repository.save(c),this.groupRepository.save(c),c}const r=this.service.edit(e,s);return this.groupRepository.edit(r),this.repository.edit(r),r}}const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function j(t,e=0){return(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase()}let g;const J=new Uint8Array(16);function K(){if(!g){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");g=crypto.getRandomValues.bind(crypto)}return g(J)}const O=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),k={randomUUID:O};function z(t,e,s){if(k.randomUUID&&!t)return k.randomUUID();t=t||{};const n=t.random??t.rng?.()??K();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,j(n)}class Q{constructor(e,s,n,d,r,l,u){this.id=e,this.name=s,this.description=n,this.create_date=d,this.completed=r,this.date=l,this.file=u}}class Y{static create(e,s=""){return new Q(z(),e.trim(),s.trim(),L.DateFormatBrazilian(),!1,null,null)}}const v=f.getQueryParams("key"),h=w(v),$=w("group"),_=new S(h),E=new U(h,f),W=new V(Y,h),X=new P($,h,M),Z=new x(_,E),ee=new H({viewModels:{groupVM:X,taskCreateVM:W,taskListVM:_,taskDetailVM:E},uis:{taskUI:Z,UiElements:i,FormUi:N,HeaderUi:C},components:{Header:q,ButtonAddTask:R,Form:A,DropDown:F,groupDropDown:G,groupForm:b},config:D});ee.render(v);
