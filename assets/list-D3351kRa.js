import{h as o,O as y,q as f,p as k,s as b,c as _}from"./h-CglQKmZx.js";import{D as M,L as S,G as U}from"./groupForm-DK8rVgn4.js";import{T,a as L}from"./taskDetailViewModel-DR09SH-F.js";const c=(t,e)=>{if(!t)throw new Error(`Elemento ${e} não encontrado`);return t},C=(t=document)=>({get task(){return c(t.getElementById("task"),"Input da Tarefa")},get main_content(){return c(t.querySelector(".main-content"),"Conteúdo principal")},get main_completed_tasks(){return c(t.querySelector(".main-drop-down-task"),"Seção principal de tarefas concluídas")},get completed_tasks(){return c(t.querySelector(".drop-down-task"),"Lista de tarefas concluídas")},get main_tasks(){return c(t.querySelector(".main-tasks"),"Lista de tarefas ativas")},get add_task(){return c(t.querySelector(".add-task"),"Botão de adicionar tarefa")},get main_form(){return c(t.querySelector(".main-form"),"Formulário principal")},get send_task(){return c(t.getElementById("send-task"),"Botão de envio da tarefa")},get button_completed_tasks(){return c(t.getElementById("button-completed-tasks"),"Botão de exibir tarefas concluídas")},get task_checkbox(){return t.querySelectorAll(".task-checkbox")},get tasks(){return t.querySelectorAll(".tasks")},get settings(){return c(t.getElementById("settings"),"Botão de configurações")},get settings_drop_down(){return c(t.querySelector(".settings-drop-down"),"Menu de configurações")}}),l=C();class B{static showDropDown(){l.settings_drop_down.classList.toggle("is-active")}}class D{static showForm(){l.add_task.style.display="none",l.main_form.style.display="flex"}static hideForm(){l.add_task.style.display="flex",l.main_form.style.display="none"}}class V{constructor(e,s){this.listViewModel=e,this.detailViewModel=s}showCompletedTasks(){l.completed_tasks.style.display==="none"||l.completed_tasks.style.display===""?(l.completed_tasks.style.display="flex",l.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-down"></span> Concluídas'):(l.completed_tasks.style.display="none",l.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-right"></span> Concluídas')}renderTask(e){l.main_tasks.innerHTML="",l.completed_tasks.innerHTML="",this.listViewModel.load().forEach(s=>{this.createTemplateTask(s,s.completed,e)})}createTemplateTask(e,s=!1,a){const n=o(T,{task:e,key:a}),r=n.querySelector(".task-checkbox");s?l.completed_tasks.appendChild(n):l.main_tasks.appendChild(n),r.addEventListener("click",()=>{this.detailViewModel.completedTask(e),e.completed&&new Audio("./completedTaskSound.mp3").play(),this.renderTask(a)})}}function I(){return o("div",{className:"settings-drop-down"},o("div",{id:"changeThemeButton",className:"drop-down-content"},o("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),o("strong",null,"Alterar tema")),o("div",{id:"sendCopy",className:"drop-down-content"},o("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),o("strong",null,"Enviar uma cópia")))}function N({title:t,dropDown:e}){return o("header",{className:"main-header"},o("a",{className:"fa-solid fa-arrow-left",href:"index.html"}),o("h1",null,t),o("div",{id:"settings",className:"fa-solid fa-ellipsis-vertical"}),o("div",{className:"main-settings"}),e)}function q(){return o("section",{className:"add-task"},o("button",null,"+"))}function x(t){return o("form",{className:"main-form",onSubmit:t},o("div",{className:"content-form"},o("button",{className:"circle-button"}),o("input",{type:"text",placeholder:"Sua tarefa",id:"task"}),o("button",{title:"Botão de adicionar tarefa",id:"send-task",className:"send-button",type:"submit"},o("span",{className:"fa-solid fa-arrow-up","aria-label":"imagem ilustrativa de inclusão de uma tarefa"}))))}function F(){return o("div",{className:"settings-drop-down"},o("div",{id:"changeThemeButton",className:"drop-down-content"},o("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),o("strong",null,"Alterar tema")),o("div",{id:"editGroup",className:"drop-down-content"},o("span",{className:"fa-solid fa-pencil","aria-label":"Botão para editar as informações do grupo atual"}),o("strong",null,"Renomear lista")),o("div",{id:"deleteGroup",className:"drop-down-content"},o("span",{className:"fa-solid fa-trash","aria-label":"Botão para excluir a lista atual"}),o("strong",null,"Excluir lista")),o("div",{id:"sendCopy",className:"drop-down-content"},o("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),o("strong",null,"Enviar uma cópia")))}class A{constructor(e,{viewModels:s={},uis:a={},components:n={},config:r}){this.viewModels=s,this.uis=a,this.components=n,this.config=r,this.color=this.viewModels.groupVM.find(e)?.color}bindUiEvents(){this.uis.UiElements.add_task.addEventListener("click",()=>{this.uis.UiElements.settings.setAttribute("disabled","true"),this.uis.FormUi.showForm()}),this.uis.UiElements.button_completed_tasks.addEventListener("click",()=>{this.uis.taskUI.showCompletedTasks(),this.uis.linesRenderer()}),this.uis.UiElements.settings.addEventListener("click",()=>{this.uis.HeaderUi.showDropDown()});const e=document.querySelector(".todo__form--container");document.getElementById("cancel")?.addEventListener("click",()=>{e.style.display="none"}),window.addEventListener("scroll",()=>{const s=document.querySelector(".main-header");window.scrollY>50?s?.classList.add("is-shrink"):s?.classList.remove("is-shrink")}),document.getElementById("changeThemeButton")?.addEventListener("click",()=>{this.uis.UiElements.main_content.classList.toggle("light-theme")}),document.getElementById("editGroup")?.addEventListener("click",()=>{e.style.display="flex"}),document.querySelectorAll(".todo__form--color-content").forEach(s=>{s.addEventListener("click",a=>{const n=a.target.dataset.color;document.documentElement.style.setProperty("--main-color",n),this.color=n})})}bindViewModelsEvents(e){document.getElementById("create")?.addEventListener("click",()=>{console.log("aaaaaaaa"),this.viewModels.groupVM.edit(this.viewModels.groupVM.find(e),{id:document.getElementById("group").value,name:document.getElementById("group").value,color:this.color,icon:Array.from(document.querySelector(".icon").classList).slice(0,2).join(" ")}),localStorage.setItem("teste de location",location.href),console.log(group.name),location.href=this.config.get("routers").list.concat(`?key=${document.getElementById("group").value}`)}),this.viewModels.taskCreateVM.subscribe(()=>{this.uis.FormUi.hideForm(),this.uis.taskUI.renderTask(e)}),this.uis.UiElements.send_task.addEventListener("click",a=>{this.uis.UiElements.settings.setAttribute("disabled","false");const n=this.uis.UiElements.task.value.trim();this.viewModels.taskCreateVM.create(n)}),document.getElementById("deleteGroup")?.addEventListener("click",()=>{this.viewModels.groupVM.remove(e),console.trace(),location.href=this.config.get("routers").home});async function s(a){if(navigator.share)try{await navigator.share({title:"Lista de tarefas",text:a}),console.log("Compartilhamento feito com sucesso!")}catch(n){console.error("Erro ao compartilhar:",n)}else alert("Seu navegador não suporta compartilhamento nativo. Por isso, copiamos a lista de tarefa para Área de transferência do seu teclado, basta apenas colar onde quiser.")}document?.getElementById("sendCopy")?.addEventListener("click",async()=>{let a=`${e}
`;const n=[],r=[];this.viewModels.taskListVM.load().forEach(d=>{d.completed?r.push(d):n.push(d)}),n.forEach(d=>{a+=`○ ${d.name}
`}),a+=`
 Concluidas:
`,r.forEach(d=>{a+=`    ● ${d.name}
`}),navigator.clipboard?navigator.clipboard.writeText(a):copyToClipboardFallback(a),s(a)})}handle(e){e.preventDefault()}render(e){this.uis.taskUI.renderTask(e),this.uis.theme(e,this.color),this.uis.UiElements.main_content.prepend(o(this.components.groupForm,{method:"put"}));let s=o(this.components.groupDropDown,null);this.config.get("mainGroups").includes(e)&&(s=o(this.components.DropDown,null));const a=o(this.components.Header,{title:e,dropDown:s});this.uis.UiElements.main_content.appendChild(a),this.uis.UiElements.main_content.appendChild(this.components.ButtonAddTask()),this.uis.UiElements.main_content.appendChild(this.components.Form(this.handle)),document.querySelector(".icon")&&(document.querySelector(".icon").classList=`${this.viewModels.groupVM.find(e)?.icon} icon`),this.uis.linesRenderer(),this.bindViewModelsEvents(e),this.bindUiEvents()}}class R extends y{constructor(e,s,a){super(),this.repository=e,this.groupRepository=s,this.service=a}find(e){return this.repository.find(e)}remove(e){this.unsubscribeAll();const s=this.repository.find(e);this.repository.remove(s),this.groupRepository.clear(e),this.notify({removed:e})}edit(e,s={}){this.unsubscribeAll();const a=s.id&&s.id!==e.id,n=s.name&&s.name!==e.name;let r;if(a||n){const d=e.name,m=s.name||e.name,E=JSON.parse(localStorage.getItem(d))||[];d!==m&&(localStorage.setItem(m,JSON.stringify(E)),localStorage.removeItem(d)),this.repository.remove(e),this.groupRepository.clear(e.id),r=this.service.edit(e,s),this.repository.save(r),this.groupRepository.save(r)}else r=this.service.edit(e,s),this.groupRepository.edit(r),this.repository.edit(r);return r}}class H extends y{constructor(e,s){super(),this.factory=e,this.repository=s}create(e,s=""){const a=this.factory.create(e,s),n=this.repository.save(a);return this.notify(a),n}}const i=[];for(let t=0;t<256;++t)i.push((t+256).toString(16).slice(1));function G(t,e=0){return(i[t[e+0]]+i[t[e+1]]+i[t[e+2]]+i[t[e+3]]+"-"+i[t[e+4]]+i[t[e+5]]+"-"+i[t[e+6]]+i[t[e+7]]+"-"+i[t[e+8]]+i[t[e+9]]+"-"+i[t[e+10]]+i[t[e+11]]+i[t[e+12]]+i[t[e+13]]+i[t[e+14]]+i[t[e+15]]).toLowerCase()}let p;const $=new Uint8Array(16);function P(){if(!p){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");p=crypto.getRandomValues.bind(crypto)}return p($)}const O=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),g={randomUUID:O};function j(t,e,s){if(g.randomUUID&&!t)return g.randomUUID();t=t||{};const a=t.random??t.rng?.()??P();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,G(a)}class J{constructor(e,s,a,n,r,d,m){this.id=e,this.name=s,this.description=a,this.create_date=n,this.completed=r,this.date=d,this.file=m}}class K{static create(e,s=""){return new J(j(),e.trim(),s.trim(),M.DateFormatBrazilian(),!1,null,null)}}function z(){const t=document.querySelector(".lines");let e=0;window.getComputedStyle(document.querySelector(".drop-down-task")).display==="flex"&&(e=document.querySelector(".drop-down-task").querySelectorAll("ol").length),t.innerHTML="";let s=9-(document.querySelector(".main-tasks").querySelectorAll("ol").length+e);for(let a=0;a<s;a++)t.appendChild(o("hr",null))}function Q(t,e){const a={Importante:"pink-theme","Meu Dia":"green-theme"}[t];a&&document.querySelector(".main-content").classList.add(a),e&&document.documentElement.style.setProperty("--main-color",e)}const h=f.getQueryParams("key"),u=k(h),Y=k("group"),w=new S(u),v=new L(u,f),W=new H(K,u),X=new R(Y,u,b),Z=new V(w,v),ee=new A(h,{viewModels:{groupVM:X,taskCreateVM:W,taskListVM:w,taskDetailVM:v},uis:{taskUI:Z,UiElements:l,FormUi:D,HeaderUi:B,linesRenderer:z,theme:Q},components:{Header:N,ButtonAddTask:q,Form:x,DropDown:I,groupDropDown:F,groupForm:U},config:_});ee.render(h);
