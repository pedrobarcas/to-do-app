import{o as _,a as E,q as p,b,p as h,s as M,c as T}from"./index-D97rUgfb.js";/* empty css               *//* empty css              */import{O as u}from"./Observable-CVQdsGiV.js";import{T as L,a as S}from"./taskDetailViewModel-CKsR-Nye.js";import{h as a}from"./h-B3JzLlQ8.js";import{v as C,D as B,s as V,G as D}from"./groupForm-D6aTN8NR.js";const l=(s,e)=>{if(!s)throw new Error(`Elemento ${e} não encontrado`);return s},U=(s=document)=>({get task(){return l(s.getElementById("task"),"Input da Tarefa")},get main_content(){return l(s.querySelector(".main-content"),"Conteúdo principal")},get main_completed_tasks(){return l(s.querySelector(".main-drop-down-task"),"Seção principal de tarefas concluídas")},get completed_tasks(){return l(s.querySelector(".drop-down-task"),"Lista de tarefas concluídas")},get main_tasks(){return l(s.querySelector(".main-tasks"),"Lista de tarefas ativas")},get add_task(){return l(s.querySelector(".add-task"),"Botão de adicionar tarefa")},get main_form(){return l(s.querySelector(".main-form"),"Formulário principal")},get send_task(){return l(s.getElementById("send-task"),"Botão de envio da tarefa")},get button_completed_tasks(){return l(s.getElementById("button-completed-tasks"),"Botão de exibir tarefas concluídas")},get task_checkbox(){return s.querySelectorAll(".task-checkbox")},get tasks(){return s.querySelectorAll(".tasks")},get settings(){return l(s.getElementById("settings"),"Botão de configurações")},get settings_drop_down(){return l(s.querySelector(".settings-drop-down"),"Menu de configurações")}}),r=U();class q{static showDropDown(){r.settings_drop_down.classList.toggle("is-active")}}class N{static showForm(){r.add_task.style.display="none",r.main_form.style.display="flex"}static hideForm(){r.add_task.style.display="flex",r.main_form.style.display="none"}}class F{constructor(e,t){this.listViewModel=e,this.detailViewModel=t}showCompletedTasks(){r.completed_tasks.style.display==="none"||r.completed_tasks.style.display===""?(r.completed_tasks.style.display="flex",r.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-down"></span> Concluídas'):(r.completed_tasks.style.display="none",r.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-right"></span> Concluídas')}async renderTask(e,t){r.main_tasks.innerHTML="",r.completed_tasks.innerHTML="",(await this.listViewModel.load(t)).forEach(o=>{this.createTemplateTask(o,o.completed,e,t)})}createTemplateTask(e,t=!1,i,o){const n=a(L,{task:e,key:i}),c=n.querySelector(".task-checkbox");t?r.completed_tasks.appendChild(n):r.main_tasks.appendChild(n),c.addEventListener("click",()=>{this.detailViewModel.completedTask(e),e.completed&&new Audio("./completedTaskSound.mp3").play(),this.renderTask(i,o)})}}function x(){return a("div",{className:"settings-drop-down"},a("div",{id:"changeThemeButton",className:"drop-down-content"},a("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),a("strong",null,"Alterar tema")),a("div",{id:"sendCopy",className:"drop-down-content"},a("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),a("strong",null,"Enviar uma cópia")))}function A({title:s,dropDown:e,href:t}){return a("header",{className:"main-header"},a("a",{className:"fa-solid fa-arrow-left",href:t}),a("h1",null,s),a("div",{id:"settings",className:"fa-solid fa-ellipsis-vertical"}),a("div",{className:"main-settings"}),e)}function I(){return a("section",{className:"add-task"},a("button",null,"+"))}function R(s){return a("form",{className:"main-form",onSubmit:s},a("div",{className:"content-form"},a("button",{className:"circle-button"}),a("input",{type:"text",placeholder:"Sua tarefa",id:"task"}),a("button",{title:"Botão de adicionar tarefa",id:"send-task",className:"send-button",type:"submit"},a("span",{className:"fa-solid fa-arrow-up","aria-label":"imagem ilustrativa de inclusão de uma tarefa"}))))}function G(){return a("div",{className:"settings-drop-down"},a("div",{id:"changeThemeButton",className:"drop-down-content"},a("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),a("strong",null,"Alterar tema")),a("div",{id:"editGroup",className:"drop-down-content"},a("span",{className:"fa-solid fa-pencil","aria-label":"Botão para editar as informações do grupo atual"}),a("strong",null,"Renomear lista")),a("div",{id:"deleteGroup",className:"drop-down-content"},a("span",{className:"fa-solid fa-trash","aria-label":"Botão para excluir a lista atual"}),a("strong",null,"Excluir lista")),a("div",{id:"sendCopy",className:"drop-down-content"},a("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),a("strong",null,"Enviar uma cópia")))}class H{constructor(e,t,i){this.group_id=e,this.task_id=t,this.user_id=i}}class ${static create(e,t,i){const o=new H(e,t,i);return{group_id:o.group_id,task_id:o.task_id,user_id:o.user_id}}}class P extends u{constructor(e,t){super(),this.factory=e,this.repository=t}async create(e,t,i){const o=this.factory.create(e,t,i);return await this.repository.save(o)}}async function j(s){if(navigator.share)try{await navigator.share({title:"Lista de tarefas",text:s})}catch(e){console.error("Erro ao compartilhar:",e)}else alert("Seu navegador não suporta compartilhamento nativo")}function O(s,e){let t=`${e}
`;const i=[],o=[];s.forEach(n=>{n.completed?o.push(n):i.push(n)}),i.forEach(n=>{t+=`○ ${n.name}
`,t+=`
 Concluidas:
`,o.forEach(c=>{t+=`    ● ${c.name}
`})}),j(t)}class z{constructor(e,{viewModels:t={},uis:i={},components:o={},styles:n={},config:c}){this.viewModels=t,this.uis=i,this.components=o,this.config=c,this.styles=n,this.group=e,this.color=this.group?.color}bindUiEvents(){this.uis.UiElements.add_task.addEventListener("click",()=>{this.uis.UiElements.settings.setAttribute("disabled","true"),this.uis.FormUi.showForm()}),this.uis.UiElements.button_completed_tasks.addEventListener("click",()=>{this.uis.taskUI.showCompletedTasks(),this.uis.linesRenderer()}),this.uis.UiElements.settings.addEventListener("click",()=>{this.uis.HeaderUi.showDropDown()});const e=document.querySelector(`.${this.styles.groupForm.container}`);document.getElementById("cancel")?.addEventListener("click",()=>{e.style.display="none"}),window.addEventListener("scroll",()=>{const t=document.querySelector(".main-header");window.scrollY>45?t?.classList.add("is-shrink"):t?.classList.remove("is-shrink")}),document.getElementById("changeThemeButton")?.addEventListener("click",()=>{this.uis.UiElements.main_content.classList.toggle("light-theme")}),document.getElementById("editGroup")?.addEventListener("click",()=>{e.style.display="flex"}),document.querySelectorAll(`.${this.styles.groupForm.colorContent}`).forEach(t=>{t.addEventListener("click",i=>{const o=i.target.dataset.color;document.documentElement.style.setProperty("--main-color",o),this.color=o})})}bindViewModelsEvents(e){this.viewModels.groupVM.subscribe(()=>{location.reload()}),document.getElementById("create")?.addEventListener("click",async()=>{this.viewModels.groupVM.edit(this.group,{name:document.getElementById("group").value,color:this.color,icon:Array.from(document.querySelector(".icon").classList).slice(0,2).join(" ")})}),this.viewModels.taskCreateVM.subscribe(()=>{this.uis.FormUi.hideForm(),this.uis.taskUI.renderTask(e,this.group.id)}),this.uis.UiElements.send_task.addEventListener("click",async()=>{this.uis.UiElements.settings.setAttribute("disabled","false");const t=this.uis.UiElements.task.value.trim();await this.viewModels.taskCreateVM.create(t,this.group.id)}),document.getElementById("deleteGroup")?.addEventListener("click",async()=>{await this.viewModels.groupVM.remove(e),location.replace(this.config.get("routers").home)}),document?.getElementById("sendCopy")?.addEventListener("click",async()=>{O(await this.viewModels.taskListVM.load(this.group.id),this.group.name)})}async render(e){this.uis.theme(e,this.color),this.uis.UiElements.main_content.prepend(a(this.components.groupForm,{method:"put"}));let t=a(this.components.groupDropDown,null);this.config.get("mainGroups").includes(e)&&(t=a(this.components.DropDown,null));const i=a(this.components.Header,{title:this.group?.name,dropDown:t,href:this.config.get("routers").home});this.uis.UiElements.main_content.appendChild(i),this.uis.UiElements.main_content.appendChild(this.components.ButtonAddTask()),this.uis.UiElements.main_content.appendChild(this.components.Form(o=>{o.preventDefault()})),document.querySelector(".icon")&&this.group&&(document.querySelector(".icon").classList=`${this.group.icon} icon`),this.bindViewModelsEvents(e),this.bindUiEvents(),await this.uis.taskUI.renderTask(e,this.group.id),this.uis.linesRenderer()}}class Q extends u{constructor(e,t,i){super(),this.repository=e,this.groupRepository=t,this.service=i}async find(e){return await this.repository.find(e)}async remove(e){this.unsubscribeAll();const t=await this.repository.find(e);await this.repository.remove(t),await this.groupRepository.remove(e),this.notify({removed:e})}async edit(e,t={}){const i=this.service.edit(e,t);console.log(i);const o=await this.repository.edit(i);return console.log(o),this.notify(i),o}}class Y extends u{constructor(e){super(),this.repository=e}async load(e){const t=await this.repository.load(e);return this.notify(),t}}class J extends u{constructor(e,t){super(),this.factory=e,this.repository=t}async create(e,t){const i=await new Promise(c=>{_(E,d=>{d&&c(d)})}),o=this.factory.create(e,i.uid,t),n=await this.repository.save(o);return this.notify(o),n}}class K{constructor(e,t,i,o,n,c,d,w,v){this.id=e,this.name=t,this.description=i,this.create_date=o,this.completed=n,this.date=c,this.file=d,this.user_id=w,this.group_id=v}}class W{static create(e,t,i){const o=new K(C(),e.trim(),"",B.DateFormatBrazilian(),!1,null,null,t,i);return{id:o.id,name:o.name,description:o.description,create_date:o.create_date,completed:o.completed,date:o.date,file:o.file,user_id:o.user_id,group_id:o.group_id}}}function X(){const s=document.querySelector(".lines");let e=0;window.getComputedStyle(document.querySelector(".drop-down-task")).display==="flex"&&(e=document.querySelector(".drop-down-task").querySelectorAll("ol").length),s.innerHTML="";let t=9-(document.querySelector(".main-tasks").querySelectorAll("ol").length+e);for(let i=0;i<t;i++)s.appendChild(a("hr",null))}function Z(s,e){const i={Importante:"pink-theme","Meu Dia":"green-theme"}[s];i&&document.querySelector(".main-content").classList.add(i),e&&document.documentElement.style.setProperty("--main-color",e)}const y=p.getQueryParams("key"),m=b("task"),ee=h("group"),te=h("relation"),g=new Y(m),f=new S(m,p),se=new J(W,m),ae=new P($,te),k=new Q(ee,m,M),oe=await k.find(y),ie=new F(g,f),ne=new z(oe,{viewModels:{groupVM:k,taskCreateVM:se,taskListVM:g,taskDetailVM:f,relationVM:ae},uis:{taskUI:ie,UiElements:r,FormUi:N,HeaderUi:q,linesRenderer:X,theme:Z},components:{Header:A,ButtonAddTask:I,Form:R,DropDown:x,groupDropDown:G,groupForm:D},styles:{groupForm:V},config:T});ne.render(y);
