import{o as _,a as E,q as h,b as M,p as y,s as b,c as S}from"./index-C9oEpwqP.js";/* empty css               *//* empty css              */import{O as u}from"./Observable-D0Vm7mY_.js";import{T,a as B}from"./taskDetailViewModel-rT2fR3fl.js";import{h as s}from"./h-B3JzLlQ8.js";import{v as L,D as C,s as D,G as V}from"./groupForm-D6aTN8NR.js";const c=(a,e)=>{if(!a)throw new Error(`Elemento ${e} não encontrado`);return a},N=(a=document)=>({get task(){return c(a.getElementById("task"),"Input da Tarefa")},get main_content(){return c(a.querySelector(".main-content"),"Conteúdo principal")},get main_completed_tasks(){return c(a.querySelector(".main-drop-down-task"),"Seção principal de tarefas concluídas")},get completed_tasks(){return c(a.querySelector(".drop-down-task"),"Lista de tarefas concluídas")},get main_tasks(){return c(a.querySelector(".main-tasks"),"Lista de tarefas ativas")},get add_task(){return c(a.querySelector(".add-task"),"Botão de adicionar tarefa")},get main_form(){return c(a.querySelector(".main-form"),"Formulário principal")},get send_task(){return c(a.getElementById("send-task"),"Botão de envio da tarefa")},get button_completed_tasks(){return c(a.getElementById("button-completed-tasks"),"Botão de exibir tarefas concluídas")},get task_checkbox(){return a.querySelectorAll(".task-checkbox")},get tasks(){return a.querySelectorAll(".tasks")},get settings(){return c(a.getElementById("settings"),"Botão de configurações")},get settings_drop_down(){return c(a.querySelector(".settings-drop-down"),"Menu de configurações")}}),r=N();class U{static showDropDown(){r.settings_drop_down.classList.toggle("is-active")}}class q{static showForm(){r.add_task.style.display="none",r.main_form.style.display="flex"}static hideForm(){r.add_task.style.display="flex",r.main_form.style.display="none"}}class F{constructor(e,t){this.listViewModel=e,this.detailViewModel=t}showCompletedTasks(){r.completed_tasks.style.display==="none"||r.completed_tasks.style.display===""?(r.completed_tasks.style.display="flex",r.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-down"></span> Concluídas'):(r.completed_tasks.style.display="none",r.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-right"></span> Concluídas')}async renderTask(e,t){r.main_tasks.innerHTML="",r.completed_tasks.innerHTML="",(await this.listViewModel.load(t)).forEach(o=>{this.createTemplateTask(o,o.completed,e,t)})}createTemplateTask(e,t=!1,i,o){const n=s(T,{task:e,key:i}),l=n.querySelector(".task-checkbox");t?r.completed_tasks.appendChild(n):r.main_tasks.appendChild(n),l.addEventListener("click",()=>{this.detailViewModel.completedTask(e),e.completed&&new Audio("./completedTaskSound.mp3").play(),this.renderTask(i,o)})}}function I(){return s("div",{className:"settings-drop-down"},s("div",{id:"changeThemeButton",className:"drop-down-content"},s("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),s("strong",null,"Alterar tema")),s("div",{id:"sendCopy",className:"drop-down-content"},s("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),s("strong",null,"Enviar uma cópia")))}function x({title:a,dropDown:e,href:t}){return s("header",{className:"main-header"},s("a",{className:"fa-solid fa-arrow-left",href:t}),s("h1",null,a),s("div",{id:"settings",className:"fa-solid fa-ellipsis-vertical"}),s("div",{className:"main-settings"}),e)}function A(){return s("section",{className:"add-task"},s("button",null,"+"))}function R(a){return s("form",{className:"main-form",onSubmit:a},s("div",{className:"content-form"},s("button",{className:"circle-button"}),s("input",{type:"text",placeholder:"Sua tarefa",id:"task"}),s("button",{title:"Botão de adicionar tarefa",id:"send-task",className:"send-button",type:"submit"},s("span",{className:"fa-solid fa-arrow-up","aria-label":"imagem ilustrativa de inclusão de uma tarefa"}))))}function G(){return s("div",{className:"settings-drop-down"},s("div",{id:"changeThemeButton",className:"drop-down-content"},s("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),s("strong",null,"Alterar tema")),s("div",{id:"editGroup",className:"drop-down-content"},s("span",{className:"fa-solid fa-pencil","aria-label":"Botão para editar as informações do grupo atual"}),s("strong",null,"Renomear lista")),s("div",{id:"deleteGroup",className:"drop-down-content"},s("span",{className:"fa-solid fa-trash","aria-label":"Botão para excluir a lista atual"}),s("strong",null,"Excluir lista")),s("div",{id:"sendCopy",className:"drop-down-content"},s("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),s("strong",null,"Enviar uma cópia")))}class H{constructor(e,t,i){this.group_id=e,this.task_id=t,this.user_id=i}}class P{static create(e,t,i){const o=new H(e,t,i);return{group_id:o.group_id,task_id:o.task_id,user_id:o.user_id}}}class $ extends u{constructor(e,t){super(),this.factory=e,this.repository=t}async create(e,t,i){const o=this.factory.create(e,t,i);return await this.repository.save(o)}}class O{constructor(e,{viewModels:t={},uis:i={},components:o={},styles:n={},config:l}){this.viewModels=t,this.uis=i,this.components=o,this.config=l,this.styles=n,this.group=e,this.color=this.group?.color}bindUiEvents(){this.uis.UiElements.add_task.addEventListener("click",()=>{this.uis.UiElements.settings.setAttribute("disabled","true"),this.uis.FormUi.showForm()}),this.uis.UiElements.button_completed_tasks.addEventListener("click",()=>{this.uis.taskUI.showCompletedTasks(),this.uis.linesRenderer()}),this.uis.UiElements.settings.addEventListener("click",()=>{this.uis.HeaderUi.showDropDown()});const e=document.querySelector(`.${this.styles.groupForm.container}`);document.getElementById("cancel")?.addEventListener("click",()=>{e.style.display="none"}),window.addEventListener("scroll",()=>{const t=document.querySelector(".main-header");window.scrollY>50?t?.classList.add("is-shrink"):t?.classList.remove("is-shrink")}),document.getElementById("changeThemeButton")?.addEventListener("click",()=>{this.uis.UiElements.main_content.classList.toggle("light-theme")}),document.getElementById("editGroup")?.addEventListener("click",()=>{e.style.display="flex"}),document.querySelectorAll(`.${this.styles.groupForm.colorContent}`).forEach(t=>{t.addEventListener("click",i=>{const o=i.target.dataset.color;document.documentElement.style.setProperty("--main-color",o),this.color=o})})}bindViewModelsEvents(e){document.getElementById("create")?.addEventListener("click",async()=>{this.viewModels.groupVM.edit(this.viewModels.groupVM.find(e),{id:document.getElementById("group").value,name:document.getElementById("group").value,color:this.color,icon:Array.from(document.querySelector(".icon").classList).slice(0,2).join(" ")}),location.href=this.config.get("routers").list.concat(`?key=${document.getElementById("group").value}`)}),this.viewModels.taskCreateVM.subscribe(()=>{this.uis.FormUi.hideForm(),this.uis.taskUI.renderTask(e,this.group.id)}),this.uis.UiElements.send_task.addEventListener("click",async t=>{this.uis.UiElements.settings.setAttribute("disabled","false");const i=this.uis.UiElements.task.value.trim();await this.viewModels.taskCreateVM.create(i,this.group.id).then(async o=>{console.log(o)})}),document.getElementById("deleteGroup")?.addEventListener("click",async()=>{await this.viewModels.groupVM.remove(e),location.href=this.config.get("routers").home}),document?.getElementById("sendCopy")?.addEventListener("click",async()=>{throw new Error("not iplemented")})}async render(e){this.uis.theme(e,this.color),this.uis.UiElements.main_content.prepend(s(this.components.groupForm,{method:"put"}));let t=s(this.components.groupDropDown,null);this.config.get("mainGroups").includes(e)&&(t=s(this.components.DropDown,null));const i=s(this.components.Header,{title:this.group?.name,dropDown:t,href:config.get("routers").home});this.uis.UiElements.main_content.appendChild(i),this.uis.UiElements.main_content.appendChild(this.components.ButtonAddTask()),this.uis.UiElements.main_content.appendChild(this.components.Form(o=>{o.preventDefault()})),document.querySelector(".icon")&&this.group&&(document.querySelector(".icon").classList=`${this.group.icon} icon`),this.bindViewModelsEvents(e),this.bindUiEvents(),await this.uis.taskUI.renderTask(e,this.group.id),this.uis.linesRenderer()}}class j extends u{constructor(e,t,i){super(),this.repository=e,this.groupRepository=t,this.service=i}async find(e){return await this.repository.find(e)}async remove(e){this.unsubscribeAll();const t=await this.repository.find(e);await this.repository.remove(t),await this.groupRepository.remove(e),this.notify({removed:e})}async edit(e,t={}){const i=t.id&&t.id!==e.id,o=t.name&&t.name!==e.name;let n;if(i||o){const l=e.name,d=t.name||e.name,p=JSON.parse(localStorage.getItem(l))||[];l!==d&&(localStorage.setItem(d,JSON.stringify(p)),localStorage.removeItem(l)),console.log("aaaa"),this.repository.remove(e),this.groupRepository.remove(e),n=this.service.edit(e,t),this.repository.save(n),this.groupRepository.save(n)}else n=this.service.edit(e,t),this.groupRepository.edit(n),this.repository.edit(n);return n}}class J extends u{constructor(e){super(),this.repository=e}async load(e){const t=await this.repository.load(e);return this.notify(),t}}class K extends u{constructor(e,t){super(),this.factory=e,this.repository=t}async create(e,t){const i=await new Promise(l=>{_(E,d=>{d&&l(d)})}),o=this.factory.create(e,i.uid,t),n=await this.repository.save(o);return this.notify(o),n}}class z{constructor(e,t,i,o,n,l,d,p,v){this.id=e,this.name=t,this.description=i,this.create_date=o,this.completed=n,this.date=l,this.file=d,this.user_id=p,this.group_id=v}}class Q{static create(e,t,i){const o=new z(L(),e.trim(),"",C.DateFormatBrazilian(),!1,null,null,t,i);return{id:o.id,name:o.name,description:o.description,create_date:o.create_date,completed:o.completed,date:o.date,file:o.file,user_id:o.user_id,group_id:o.group_id}}}function Y(){const a=document.querySelector(".lines");let e=0;window.getComputedStyle(document.querySelector(".drop-down-task")).display==="flex"&&(e=document.querySelector(".drop-down-task").querySelectorAll("ol").length),a.innerHTML="";let t=9-(document.querySelector(".main-tasks").querySelectorAll("ol").length+e);for(let i=0;i<t;i++)a.appendChild(s("hr",null))}function W(a,e){const i={Importante:"pink-theme","Meu Dia":"green-theme"}[a];i&&document.querySelector(".main-content").classList.add(i),e&&document.documentElement.style.setProperty("--main-color",e)}const g=h.getQueryParams("key"),m=M("task"),X=y("group"),Z=y("relation"),f=new J(m),k=new B(m,h),ee=new K(Q,m),te=new $(P,Z),w=new j(X,m,b),se=await w.find(g),ae=new F(f,k),oe=new O(se,{viewModels:{groupVM:w,taskCreateVM:ee,taskListVM:f,taskDetailVM:k,relationVM:te},uis:{taskUI:ae,UiElements:r,FormUi:q,HeaderUi:U,linesRenderer:Y,theme:W},components:{Header:x,ButtonAddTask:A,Form:R,DropDown:I,groupDropDown:G,groupForm:V},styles:{groupForm:D},config:S});oe.render(g);
