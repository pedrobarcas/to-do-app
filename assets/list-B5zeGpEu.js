import{O as y,h as i,q as k,p as f,s as _,c as M}from"./h-CMHm9qIN.js";import{D as S,L as b,G as U}from"./groupForm-CsmJ4MaM.js";import{T,a as L}from"./taskDetailViewModel-KBlBjcYa.js";class V extends y{constructor(e,s){super(),this.factory=e,this.repository=s}create(e,s=""){const n=this.factory.create(e,s),r=this.repository.save(n);return this.notify(n),r}}const d=(t,e)=>{if(!t)throw new Error(`Elemento ${e} não encontrado`);return t},D=(t=document)=>({get task(){return d(t.getElementById("task"),"Input da Tarefa")},get main_content(){return d(t.querySelector(".main-content"),"Conteúdo principal")},get main_completed_tasks(){return d(t.querySelector(".main-drop-down-task"),"Seção principal de tarefas concluídas")},get completed_tasks(){return d(t.querySelector(".drop-down-task"),"Lista de tarefas concluídas")},get main_tasks(){return d(t.querySelector(".main-tasks"),"Lista de tarefas ativas")},get add_task(){return d(t.querySelector(".add-task"),"Botão de adicionar tarefa")},get main_form(){return d(t.querySelector(".main-form"),"Formulário principal")},get send_task(){return d(t.getElementById("send-task"),"Botão de envio da tarefa")},get button_completed_tasks(){return d(t.getElementById("button-completed-tasks"),"Botão de exibir tarefas concluídas")},get task_checkbox(){return t.querySelectorAll(".task-checkbox")},get tasks(){return t.querySelectorAll(".tasks")},get settings(){return d(t.getElementById("settings"),"Botão de configurações")},get settings_drop_down(){return d(t.querySelector(".settings-drop-down"),"Menu de configurações")}}),a=D();class q{static showDropDown(){a.settings_drop_down.classList.toggle("is-active")}}class I{static showForm(){a.add_task.style.display="none",a.main_form.style.display="flex"}static hideForm(){a.add_task.style.display="flex",a.main_form.style.display="none"}}class C{constructor(e,s){this.listViewModel=e,this.detailViewModel=s}showCompletedTasks(){a.completed_tasks.style.display==="none"||a.completed_tasks.style.display===""?(a.completed_tasks.style.display="flex",a.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-down"></span> Concluídas'):(a.completed_tasks.style.display="none",a.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-right"></span> Concluídas')}renderTask(e){a.main_tasks.innerHTML="",a.completed_tasks.innerHTML="",this.listViewModel.load().forEach(s=>{this.createTemplateTask(s,s.completed,e)})}createTemplateTask(e,s=!1,n){const r=i(T,{task:e,key:n}),l=r.querySelector(".task-checkbox");s?a.completed_tasks.appendChild(r):a.main_tasks.appendChild(r),l.addEventListener("click",()=>{this.detailViewModel.completedTask(e),e.completed&&new Audio("./completedTaskSound.mp3").play(),this.renderTask(n)})}}function B(){return i("div",{className:"settings-drop-down"},i("p",{id:"changeThemeButton"},i("span",{className:"fa-solid fa-palette","aria-label":"imagem ilustrativa de uma palheta artística"}),"Alterar tema"))}function x({title:t,dropDown:e}){return i("header",{className:"main-header"},i("a",{className:"fa-solid fa-arrow-left",href:"index.html"}),i("h1",null,t),i("div",{id:"settings",className:"fa-solid fa-ellipsis-vertical"}),i("div",{className:"main-settings"}),e)}function N(){return i("section",{className:"add-task"},i("button",null,"+"))}function F(){return i("section",{className:"main-form"},i("div",{className:"content-form"},i("input",{type:"text",placeholder:"Sua tarefa",id:"task"}),i("button",{id:"send-task"},i("span",{className:"fa-solid fa-arrow-up","aria-label":"imagem ilustrativa de inclusão de uma tarefa"}))))}function A(){return i("div",{className:"settings-drop-down"},i("div",{id:"changeThemeButton",className:"drop-down-content"},i("span",{className:"fa-solid fa-palette","aria-label":"imagem ilustrativa de uma palheta artística"}),"Alterar tema"),i("div",{id:"editGroup",className:"drop-down-content"},i("span",{className:"fa-solid fa-pencil"}),"Renomear lista"),i("div",{id:"deleteGroup",className:"drop-down-content"},i("span",{className:"fa-solid fa-trash"}),"Excluir lista"))}class R{constructor(e,{viewModels:s={},uis:n={},components:r={},config:l}){this.viewModels=s,this.uis=n,this.components=r,this.config=l,this.color=this.viewModels.groupVM.find(e)?.color}bindUiEvents(){this.uis.UiElements.add_task.addEventListener("click",()=>{this.uis.UiElements.settings.setAttribute("disabled","true"),this.uis.FormUi.showForm()}),this.uis.UiElements.button_completed_tasks.addEventListener("click",()=>{this.uis.taskUI.showCompletedTasks(),this.uis.linesRenderer()}),this.uis.UiElements.settings.addEventListener("click",()=>{this.uis.HeaderUi.showDropDown()});const e=document.querySelector(".todo__form--container");document.getElementById("cancel")?.addEventListener("click",()=>{e.style.display="none"}),window.addEventListener("scroll",()=>{const s=document.querySelector(".main-header");window.scrollY>50?s?.classList.add("is-shrink"):s?.classList.remove("is-shrink")}),document.getElementById("changeThemeButton")?.addEventListener("click",()=>{this.uis.UiElements.main_content.classList.toggle("light-theme")}),document.getElementById("editGroup")?.addEventListener("click",()=>{e.style.display="flex"}),document.querySelectorAll(".todo__form--color-content").forEach(s=>{s.addEventListener("click",n=>{const r=n.target.dataset.color;document.documentElement.style.setProperty("--main-color",r),this.color=r})})}bindViewModelsEvents(e){document.querySelector(".todo__form--container"),this.viewModels.groupVM.subscribe(s=>{location.href=this.config.get("routers").list.concat(`?key=${s.name}`)}),document.getElementById("create")?.addEventListener("click",()=>{this.viewModels.groupVM.edit(this.viewModels.groupVM.find(e),{id:document.getElementById("group").value,name:document.getElementById("group").value,color:this.color,icon:Array.from(document.querySelector(".icon").classList).slice(0,2).join(" ")})}),this.viewModels.taskCreateVM.subscribe(()=>{this.uis.FormUi.hideForm(),this.uis.taskUI.renderTask(e)}),this.uis.UiElements.send_task.addEventListener("click",()=>{this.uis.UiElements.settings.setAttribute("disabled","false");const s=this.uis.UiElements.task.value.trim();this.viewModels.taskCreateVM.create(s)}),document.getElementById("deleteGroup")?.addEventListener("click",()=>{this.viewModels.groupVM.remove(e),location.href=this.config.get("routers").home})}render(e){this.uis.taskUI.renderTask(e),this.uis.theme(e,this.color),this.uis.UiElements.main_content.prepend(i(this.components.groupForm,{method:"puta"}));let s=i(this.components.groupDropDown,null);this.config.get("mainGroups").includes(e)&&(s=i(this.components.DropDown,null));const n=i(this.components.Header,{title:e,dropDown:s});this.uis.UiElements.main_content.appendChild(n),this.uis.UiElements.main_content.appendChild(this.components.ButtonAddTask()),this.uis.UiElements.main_content.appendChild(this.components.Form()),document.querySelector(".icon")&&(document.querySelector(".icon").classList=`${this.viewModels.groupVM.find(e)?.icon} icon`),this.uis.linesRenderer(),this.bindUiEvents(),this.bindViewModelsEvents(e)}}class H extends y{constructor(e,s,n){super(),this.repository=e,this.groupRepository=s,this.service=n}find(e){return this.repository.find(e)}remove(e){this.unsubscribeAll();const s=this.repository.find(e);this.repository.remove(s),this.groupRepository.clear(e),this.notify({removed:e})}edit(e,s={}){const n=s.id&&s.id!==e.id,r=s.name&&s.name!==e.name;let l;if(n||r){const c=e.name,m=s.name||e.name,E=JSON.parse(localStorage.getItem(c))||[];c!==m&&(localStorage.setItem(m,JSON.stringify(E)),localStorage.removeItem(c)),this.repository.remove(e),this.groupRepository.clear(e.id),l=this.service.edit(e,s),this.repository.save(l),this.groupRepository.save(l)}else l=this.service.edit(e,s),this.groupRepository.edit(l),this.repository.edit(l);return this.notify(l),l}}const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function G(t,e=0){return(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase()}let p;const O=new Uint8Array(16);function P(){if(!p){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");p=crypto.getRandomValues.bind(crypto)}return p(O)}const j=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),g={randomUUID:j};function $(t,e,s){if(g.randomUUID&&!t)return g.randomUUID();t=t||{};const n=t.random??t.rng?.()??P();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,G(n)}class J{constructor(e,s,n,r,l,c,m){this.id=e,this.name=s,this.description=n,this.create_date=r,this.completed=l,this.date=c,this.file=m}}class K{static create(e,s=""){return new J($(),e.trim(),s.trim(),S.DateFormatBrazilian(),!1,null,null)}}function z(){const t=document.querySelector(".lines");let e=0;window.getComputedStyle(document.querySelector(".drop-down-task")).display==="flex"&&(e=document.querySelector(".drop-down-task").querySelectorAll("ol").length),t.innerHTML="";let s=9-(document.querySelector(".main-tasks").querySelectorAll("ol").length+e);for(let n=0;n<s;n++)t.appendChild(i("hr",null))}function Q(t,e){const n={Importante:"pink-theme","Meu Dia":"green-theme"}[t];n&&document.querySelector(".main-content").classList.add(n),e&&document.documentElement.style.setProperty("--main-color",e)}const h=k.getQueryParams("key"),u=f(h),Y=f("group"),w=new b(u),v=new L(u,k),W=new V(K,u),X=new H(Y,u,_),Z=new C(w,v),ee=new R(h,{viewModels:{groupVM:X,taskCreateVM:W,taskListVM:w,taskDetailVM:v},uis:{taskUI:Z,UiElements:a,FormUi:I,HeaderUi:q,linesRenderer:z,theme:Q},components:{Header:x,ButtonAddTask:N,Form:F,DropDown:B,groupDropDown:A,groupForm:U},config:M});ee.render(h);
