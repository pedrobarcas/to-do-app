import{O as m,o as E,a as _,q as p,b,p as h,s as M,c as T}from"./index-CHvACQ46.js";/* empty css               *//* empty css              */import"./private-check-BEvfN6Bv.js";import{T as L,a as S}from"./taskDetailViewModel-CIaNo4KO.js";import{h as s}from"./h-B3JzLlQ8.js";import{v as C,D as B,s as D,G as U}from"./groupForm-D6aTN8NR.js";const l=(a,e)=>{if(!a)throw new Error(`Elemento ${e} não encontrado`);return a},q=(a=document)=>({get task(){return l(a.getElementById("task"),"Input da Tarefa")},get main_content(){return l(a.querySelector(".main-content"),"Conteúdo principal")},get main_completed_tasks(){return l(a.querySelector(".main-drop-down-task"),"Seção principal de tarefas concluídas")},get completed_tasks(){return l(a.querySelector(".drop-down-task"),"Lista de tarefas concluídas")},get main_tasks(){return l(a.querySelector(".main-tasks"),"Lista de tarefas ativas")},get add_task(){return l(a.querySelector(".add-task"),"Botão de adicionar tarefa")},get main_form(){return l(a.querySelector(".main-form"),"Formulário principal")},get send_task(){return l(a.getElementById("send-task"),"Botão de envio da tarefa")},get button_completed_tasks(){return l(a.getElementById("button-completed-tasks"),"Botão de exibir tarefas concluídas")},get task_checkbox(){return a.querySelectorAll(".task-checkbox")},get tasks(){return a.querySelectorAll(".tasks")},get settings(){return l(a.getElementById("settings"),"Botão de configurações")},get settings_drop_down(){return l(a.querySelector(".settings-drop-down"),"Menu de configurações")}}),n=q();class N{static showDropDown(){n.settings_drop_down.classList.toggle("is-active")}}class V{static showForm(){n.add_task.style.display="none",n.main_form.style.display="flex"}static hideForm(){n.add_task.style.display="flex",n.main_form.style.display="none"}}class F{constructor(e,t){this.listViewModel=e,this.detailViewModel=t}showCompletedTasks(){n.completed_tasks.style.display==="none"||n.completed_tasks.style.display===""?(n.completed_tasks.style.display="flex",n.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-down"></span> Concluídas'):(n.completed_tasks.style.display="none",n.button_completed_tasks.innerHTML='<span class="fa-solid fa-chevron-right"></span> Concluídas')}async renderTask(e,t){n.main_tasks.innerHTML="",n.completed_tasks.innerHTML="",(await this.listViewModel.load(t)).forEach(o=>{this.createTemplateTask(o,o.completed,e,t)})}createTemplateTask(e,t=!1,i,o){const r=s(L,{task:e,key:i}),c=r.querySelector(".task-checkbox");t?n.completed_tasks.appendChild(r):n.main_tasks.appendChild(r),c.addEventListener("click",()=>{this.detailViewModel.completedTask(e),e.completed&&new Audio("./completedTaskSound.mp3").play(),this.renderTask(i,o)})}}function x(){return s("div",{className:"settings-drop-down"},s("div",{id:"changeThemeButton",className:"drop-down-content"},s("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),s("strong",null,"Alterar tema")),s("div",{id:"sendCopy",className:"drop-down-content"},s("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),s("strong",null,"Enviar uma cópia")))}function A({title:a,dropDown:e,href:t}){return s("header",{className:"main-header"},s("a",{className:"fa-solid fa-arrow-left",href:t}),s("h1",null,a),s("div",{id:"settings",className:"fa-solid fa-ellipsis-vertical"}),s("div",{className:"main-settings"}),e)}function I(){return s("section",{className:"add-task"},s("button",null,"+"))}function G(a){return s("form",{className:"main-form",onSubmit:a},s("div",{className:"content-form"},s("button",{className:"circle-button"}),s("input",{type:"text",placeholder:"Sua tarefa",id:"task"}),s("button",{title:"Botão de adicionar tarefa",id:"send-task",className:"send-button",type:"submit"},s("span",{className:"fa-solid fa-arrow-up","aria-label":"imagem ilustrativa de inclusão de uma tarefa"}))))}function H(){return s("div",{className:"settings-drop-down"},s("div",{id:"changeThemeButton",className:"drop-down-content"},s("span",{className:"fa-solid fa-palette","aria-label":"Botão para alterar o tema da lista atual"}),s("strong",null,"Alterar tema")),s("div",{id:"editGroup",className:"drop-down-content"},s("span",{className:"fa-solid fa-pencil","aria-label":"Botão para editar as informações do grupo atual"}),s("strong",null,"Renomear lista")),s("div",{id:"deleteGroup",className:"drop-down-content"},s("span",{className:"fa-solid fa-trash","aria-label":"Botão para excluir a lista atual"}),s("strong",null,"Excluir lista")),s("div",{id:"sendCopy",className:"drop-down-content"},s("span",{className:"fa-solid fa-copy","aria-label":"Botão para enviar uma cópia da lista de tarefas atual"}),s("strong",null,"Enviar uma cópia")))}async function R(a){if(navigator.share)try{await navigator.share({title:"Lista de tarefas",text:a})}catch(e){console.error("Erro ao compartilhar:",e)}else alert("Seu navegador não suporta compartilhamento nativo")}function $(a,e){let t=`${e}
`;const i=[],o=[];a.forEach(r=>{r.completed?o.push(r):i.push(r)}),i.forEach(r=>{t+=`○ ${r.name}
`,t+=`
 Concluidas:
`,o.forEach(c=>{t+=`    ● ${c.name}
`})}),R(t)}class P{constructor(e,{viewModels:t={},uis:i={},components:o={},styles:r={},config:c}){this.viewModels=t,this.uis=i,this.components=o,this.config=c,this.styles=r,this.group=e,this.color=this.group?.color}bindUiEvents(){this.uis.UiElements.add_task.addEventListener("click",()=>{this.uis.UiElements.settings.setAttribute("disabled","true"),this.uis.FormUi.showForm()}),this.uis.UiElements.button_completed_tasks.addEventListener("click",()=>{this.uis.taskUI.showCompletedTasks(),this.uis.linesRenderer()}),this.uis.UiElements.settings.addEventListener("click",()=>{this.uis.HeaderUi.showDropDown()});const e=document.querySelector(`.${this.styles.groupForm.container}`);document.getElementById("cancel")?.addEventListener("click",()=>{e.style.display="none"}),window.addEventListener("scroll",()=>{const t=document.querySelector(".main-header");window.scrollY>45?t?.classList.add("is-shrink"):t?.classList.remove("is-shrink")}),document.getElementById("changeThemeButton")?.addEventListener("click",()=>{this.uis.UiElements.main_content.classList.toggle("light-theme")}),document.getElementById("editGroup")?.addEventListener("click",()=>{e.style.display="flex"}),document.querySelectorAll(`.${this.styles.groupForm.colorContent}`).forEach(t=>{t.addEventListener("click",i=>{const o=i.target.dataset.color;document.documentElement.style.setProperty("--main-color",o),this.color=o})})}bindViewModelsEvents(e){this.viewModels.groupVM.subscribe(()=>{location.reload()}),document.getElementById("create")?.addEventListener("click",async()=>{this.viewModels.groupVM.edit(this.group,{name:document.getElementById("group").value,color:this.color,icon:Array.from(document.querySelector(".icon").classList).slice(0,2).join(" ")})}),this.viewModels.taskCreateVM.subscribe(()=>{this.uis.taskUI.renderTask(e,this.group.id)}),this.uis.UiElements.send_task.addEventListener("click",async()=>{this.uis.UiElements.settings.setAttribute("disabled","false");const t=this.uis.UiElements.task.value.trim();this.uis.FormUi.hideForm(),this.viewModels.taskCreateVM.create(t,this.group.id)}),document.getElementById("deleteGroup")?.addEventListener("click",async()=>{await this.viewModels.groupVM.remove(e),location.replace(this.config.get("routers").home)}),document?.getElementById("sendCopy")?.addEventListener("click",async()=>{$(await this.viewModels.taskListVM.load(this.group.id),this.group.name)})}async render(e){this.uis.theme(e,this.color),this.uis.UiElements.main_content.prepend(s(this.components.groupForm,{method:"put"}));let t=s(this.components.groupDropDown,null);this.config.get("mainGroups").includes(e)&&(t=s(this.components.DropDown,null));const i=s(this.components.Header,{title:this.group?.name,dropDown:t,href:this.config.get("routers").home});this.uis.UiElements.main_content.appendChild(i),this.uis.UiElements.main_content.appendChild(this.components.ButtonAddTask()),this.uis.UiElements.main_content.appendChild(this.components.Form(o=>{o.preventDefault()})),document.querySelector(".icon")&&this.group&&(document.querySelector(".icon").classList=`${this.group.icon} icon`),this.bindViewModelsEvents(e),this.bindUiEvents(),await this.uis.taskUI.renderTask(e,this.group.id),this.uis.linesRenderer()}}class j extends m{constructor(e,t,i){super(),this.repository=e,this.groupRepository=t,this.service=i}async find(e){return await this.repository.find(e)}async remove(e){this.unsubscribeAll();const t=await this.repository.find(e);await this.repository.remove(t),await this.groupRepository.remove(e),this.notify({removed:e})}async edit(e,t={}){const i=this.service.edit(e,t);console.log(i);const o=await this.repository.edit(i);return console.log(o),this.notify(i),o}}class O extends m{constructor(e){super(),this.repository=e}async load(e){const t=await this.repository.load(e);return this.notify(),t}}class z extends m{constructor(e,t){super(),this.factory=e,this.repository=t}async create(e,t){const i=await new Promise(c=>{E(_,d=>{d&&c(d)})}),o=this.factory.create(e,i.uid,t),r=await this.repository.save(o);return this.notify(o),r}}class Q{constructor(e,t,i,o,r,c,d,w,v){this.id=e,this.name=t,this.description=i,this.create_date=o,this.completed=r,this.date=c,this.file=d,this.user_id=w,this.group_id=v}}class Y{static create(e,t,i){const o=new Q(C(),e.trim(),"",B.DateFormatBrazilian(),!1,null,null,t,i);return{id:o.id,name:o.name,description:o.description,create_date:o.create_date,completed:o.completed,date:o.date,file:o.file,user_id:o.user_id,group_id:o.group_id}}}function J(){const a=document.querySelector(".lines");let e=0;window.getComputedStyle(document.querySelector(".drop-down-task")).display==="flex"&&(e=document.querySelector(".drop-down-task").querySelectorAll("ol").length),a.innerHTML="";let t=9-(document.querySelector(".main-tasks").querySelectorAll("ol").length+e);for(let i=0;i<t;i++)a.appendChild(s("hr",null))}function K(a,e){const i={Importante:"pink-theme","Meu Dia":"green-theme"}[a];i&&document.querySelector(".main-content").classList.add(i),e&&document.documentElement.style.setProperty("--main-color",e)}const g=p.getQueryParams("key"),u=b("task"),W=h("group");h("relation");const f=new O(u),y=new S(u,p),X=new z(Y,u),k=new j(W,u,M),Z=await k.find(g),ee=new F(f,y),te=new P(Z,{viewModels:{groupVM:k,taskCreateVM:X,taskListVM:f,taskDetailVM:y},uis:{taskUI:ee,UiElements:n,FormUi:V,HeaderUi:N,linesRenderer:J,theme:K},components:{Header:A,ButtonAddTask:I,Form:G,DropDown:x,groupDropDown:H,groupForm:U},styles:{groupForm:D},config:T});te.render(g);
